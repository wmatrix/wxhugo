+++
date = "2018-01-09T22:55:58-08:00"
title = "麦克风阵列声源定位研究"
tags = ["speech","signal"]
topics = ["compute"]

+++

# 阵列信号处理
空间谱估计理论

## 多重信号分类算法（MUSIC）应用
波达方向(DOA)估计的基本问题就是确定同时处在空间某一区域内多个感兴趣的信号的空间位置(即多个信号到达阵列参考阵元的方向角)。最早的也是最经典的超分辨DOA估计方法是著名的MUSIC方法，MUSIC是多重信号分类(Multiple Signal Classification)的英文缩写。它是由R.O.Schmidt于1979年提出来的，由1986年重新发表的。MUSIC算法利用了信号子空间和噪声子空间的正交性，构造空间谱函数，通过谱峰搜索，检测信号的DOA。

## 传统声源定位检测方法
* **基于可控波束形成器的声源定位**：该方法对麦克风阵列接收到的语音信号进行滤波、加权求和，然后直接控制麦克风指向使波束有最大输出功率的方向;
* **基于高分辨率谱估计的定向技术**：该方法利用求解麦克信号间的相关矩阵来定出方向角，从而进一步定出声源位置。
* **基于到达时间差(TDOA)技术**：该方法首先求出声音到达不同位置麦克的时间差，再利用该时间差求得声音到达不同位置麦克的距离差，最后用搜索或几何知识确定声源位置。

基于可控波束形成的定位方法是出现比较早、并在实际中得到应用的一种定位方法。基于可控波束形成的定位主要分为延迟累加波束法和自适应波束法。前者运算量小，信号失真小，但抗噪性能低，需要较多的麦克才有比较好的效果。后者因为加了自适应滤波，所以运算量比较大，而且输出信号有一定程度的失真，但需要的麦克数目相对较少，在没有混响时有比较好的效果。基于到达时间差(TDOA)技术的定位方法运算量最小，原理简单，但是其需要得到声波到达各麦克风的精确的相位延迟，这对麦克风以及各输入和采集通道的性能一致性要求很高，不易实现。

声源定位技术在人工智能领域应用广泛，利用麦克风阵列来形成空间笛卡尔坐标系，根据不同的线性阵列，平面阵列和空间阵列，来确定声源在空间中的位置。了解声源定位技术之前，我们需要了解近场模型和远场模型。

![近场模型与远程模型](http://img.blog.csdn.net/20160901090915042)

通常麦克风阵列的距离为1~3m，阵列处于近场模型，麦克风阵列接受的是球面波而不是平面波，声波在传播的过程中会发生衰减，而衰减因子与传播的距离成正比，因此声波从声源到达阵元时候的幅度也各不相同。而远场模型中，声源到阵元的距离差相对较小，可以忽略。通常，我们定义2L²/λ为远近场临界值，L为阵列孔径，λ为声波波长，因此阵元接受信号不仅有相位延时还有幅度衰减。

## 麦克风阵列近场声源定位模型
利用麦克风阵列进行声源定位与传统的阵列信号处理理论所研究的对象信号最本质的区别是声音（语音）信号具有非平稳性，近场模型，和宽带信号这几个特点。
在近场情况下，必须采用精确的球面波前模型，来代替远场的平面波前模型。声波在传播过程中要发生幅度衰减，其幅度衰减因子与传播距离成正比。麦克风阵列的各个阵元到声源的距离是不同的，因此声波波前到达各个阵元时，幅度是不同的。近场模型和远场模型最主要的区别在于：是否考虑阵列的各个阵元因接收信号幅度衰减的不同所带来的影响。对于远场声源，麦克风阵元接收的信号之间幅度差别相对很小，可以忽略不计;但对于近场声源，麦克风阵元接收的信号之间幅度差别较大，必须予以考虑。

传统的阵列信号处理技术直接应用到麦克风阵列处理系统中往往效果不理想，其原因在于麦克风阵列处理有不同的处理特点：

1. **阵列模型的建立**

	麦克风主要应用处理语音信号，拾音范围有限，且多用于近场模型，使得常规的阵列处理方法如雷达，声呐等平面波远场模型不再适用，在近场模型中，需要更加精准的*球面波*，需要考虑传播路径不同引起的幅度衰减不同。

2. **宽带信号处理** 

	通常的阵列信号处理多为窄带，即不同阵元在接受时延与相位差主要体现在载波频率，而语音信号未经过调制也没有载波，且高低频之比较大，不同阵元的相位延时与声源本身的特性关系很大—频率密切相关，使得传统的阵列信号处理方法不再完全适用。

3. **非平稳信号处理** 

	传统阵列处理中，多为平稳信号，而麦克风阵列的处理信号多是非平稳信号，或者*短时平稳信号*，因此麦克风阵列一般对信号做短时频域处理，每个频域均对应一个相位差，将宽带信号在频域上分成多个子带，每个子带做窄带处理，再合并成宽带谱。

4. **混响** 

	声音传播受空间影响较大，由于空间反射，衍射，麦克风收到的信号除了直达信号以外，还有*多径信号叠加*，使得信号被干扰，即为混响。在室内环境中，受房间边界或者障碍物衍射，反射导致声音延续，极大程度的影响语音的可懂度。

### 阵列技术未来发展

麦克风阵列技术相对于单麦克风系统有很多优点，已成为语音增强及语音信号处理的重要部分。语音增强和声源定位已经成为阵列技术中不可缺少的部分，在视频会议，智能机器人，助听器，智能家电，通信，智能玩具，车载领域都需要声源定位和语音增强。各种信号处理技术，阵列信号处理技术都陆续结合到麦克风阵列的语音处理系统当中，并逐渐得到算法改进和进一步的广泛应用。在复杂的噪声环境，混响环境，声学环境下，强大的硬件处理能力也使得复杂算法实时处理语音增强成为了可能。在未来，语音和图像的紧密结合会成为人工智能领域的新的突破口，在人工智能的风口浪尖，是谁能将语音识别，语音理解，阵列信号处理，远场语音，图像识别，人脸识别，虹膜识别，声纹识别的技术巧妙并有机的结合在一起，并将技术的本质和与人为本的宗旨完美的结合，让我们拭目以待。

## 谱抵消去噪及语音检测
由于麦克风的拾音范围有限，当声源离阵列较远时，麦克风采集到的信号较弱，这时就需要对信号进行放大。但是，在信号放大的同时，背景噪声也被放大了。这样，阵列采集到的信号质量很差，算法处理的效果会受到影响，因此，需要先进行预处理，去背景噪声。而且，在使用麦克风阵列处理各帧采样数据时，该帧数据中是否含有语音信号所需的运算量相差很大。如果不加区别，则严重影响了算法的实时性，浪费了系统资源。因此，对采样数据进行语音检测非常必要。因此本节重点讲述在进行声源定位算法实施前，对采集到的语音信号的必要的预处理过程：即谱抵消去噪及语音检测。

### 谱抵消去噪
1. 当阵列收到一帧数据x[n],n=1,2，…，fLen之后，fLen定义的帧长，首先对该帧信号进行短时傅里叶变换(STFT)，得到频域值X[k,t]，k=1,2，…，fLen，τ为短时傅里叶变换的时间参数。
2. 接着根据X[k,t]进行判断，如果max{X[k,t]}<=threshold，或者超过threshold的频率不在语音范围之内，则认为本帧为噪声帧，否则为语音帧，其中threshold为一门限值，它的值既可以根据经验事先设定，也可以由具体环境来确定。
3. 如果本帧数据为噪声，则更新噪声幅度谱的值，也就是使噪声幅度谱始终保持为最近的噪声偏置;如果本帧数据为语音，则用接收信号的幅度谱在频域减去噪声幅度谱，即以最近的噪声模拟当前的噪声，从而去除背景噪声，得到降噪后的信号幅度谱。

谱抵消技术能够用于去处背景噪声，提高语音检测算法的准确率，但在应用中需要注意两点：
1. 噪声和语音信号在评语重叠很厉害，单靠谱抵消算法从本质上来说无法有效去噪。
2. 考虑到实时性，过于复杂的谱抵消会影响系统的实时性。

### 语音检测VAD（Video Activity Detection）
VAD技术广泛地应用于各种语音处理系统中，语音识别过程需要进行起止点判决，语音增强算法要求从含噪语音中提取噪声进行统计，语音编码可以利用“语音插空”以增加信道容量。这些都离不开VAD技术。在许多实际应用中，首先应用VAD之后，使得后续处理只需针对语音段进行，减少了无谓的计算量和数据量，提高了与用户的实时交互性。

语音检测VAD算法有很多种，但是其大致可分为两类：
* *基于语音与噪声的统计信息的自适应检测方法*

自适应检测方法虽然适应性广，但需要事先对语音和噪声模型进行训练以得到背景噪声和语音的统计信息，而且大部分算法要求背景噪声保持平稳，信噪比要求较高。但是实际环境中很难满足这些条件。另外，自适应检测算法实现起来耗时多，不易实时实现。

* *基于固定检测条件的非自适应检测方法*

非自适应检测方法的基本思想是从输入信号中提取一些度量特征值，再与相应的门限值进行比较。VAD算法一般都以帧为单位，逐帧进行判断，每帧的长度为20-40ms门限值一般是从单纯的噪声中获取的。若计算得到的度量值大于门限，则为有音帧(活动帧)，否则为无音帧(非活动帧)，因此这类方法也可称之为阈值比较法。这类算法关键是如何选择度里特征值，以及如何定义和更新门限。一个好的VAD算法应该具有简单、自适应、对噪声环境的鲁棒性以及能够实时处理等特点。


# 语音信号分析

## 时域特征分析

1. 短时能量与短时平均幅度

	主要用途在于浊音段与清音段，因为浊音时短时能量比清音时大很多；区分声母和韵母的分界，以及有话段与无话段的分界。

2. 短时平均过零率

	表示一帧语音信号中语音数据穿过横轴（零电平）的次数。对于离散信号，如果相邻的采样值符号改变，则成为过零。短时平均过零率就是样本值符号改变的次数。

浊音具有较低的频率，因而相对具有较低的过零率；清音具有较高的频率，因而具有较高的过零率。利用短时平均过零率，可以从背景噪声中找出语音信号。在背景噪声较小时，使用短时能量与短时平均幅度识别较为有效；而在背景噪声较大时，用短时过零率识别较为有效。

3. 短时自相关函数

	主要应用于端点检测与基音提取，在韵母基因频率整数倍处将出现峰值特性，而在声母的短时自相关函数中看不到明显的峰值。

4. 短时平均幅度差函数（AMDF）

	可以用于基音周期检测。

## 频域特征分析

短时傅立叶变换（Short Time Fourier Transform，STFT），短时傅立叶分析（Short Time Fourier Analysis,STFA)用于语音信号分析。

1. 语谱图
2. 短时功率谱密度
